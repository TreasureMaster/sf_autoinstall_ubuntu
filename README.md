# Автоматизация установки пакетов для модулей SF 2 блока

> **_Причина:_** Надоело переустанавливать серверы для решения задания SF.

> **_Цель:_** Автоматизировать установку и удаление пакетов.

> **_Внимание!!!_** Makefile создавался и тестировался в Ubuntu 20. В остальных ОС могут быть нужны доработки.

### Описание констант

> **_Важно!!!_** Данные для БД в `Makefile` должны совпадать с данными в SQL-скрипте `wp_init.sql`. Автоматизация этого не сделана!

1. `APACHEPORTS_CONF` - путь к конфигу портов Apache
2. `APACHE_SITES` - часть пути, куда записываются возможные конфиги сайтов Apache
3. `NGINX_SITES` - часть пути, куда записываются возможные конфиги сайтов Nginx
4. `PHPv1` и `PHPv2` - версии PHP, которые нужно установить
5. `PHP1_CONF` и `PHP2_CONF` - пути к их файлам конфигурации
6. `WP_LOCALHOST_CONFIG` - путь к файлу конфигов wordpress
7. `WP_DB_NAME` - имя БД для wordpress
8. `WP_DB_USER` - имя юзера этой БД
9. `WP_DB_PASSWORD` - пароль юзера для входа в БД
10. настройки bind9 не описываются...

### Описание этапов

Этапы выполняются командой `make`. Поэому в самом начале необходимо установить этот пакет в систему.

1. `make apache` - установка веб-сервера Apache (юнит 9.4)
2. `make example` - установка первого тестового сайта (юнит 9.4)
3. `make php` - установка разных версий PHP, указанных в настройках (сейчас - 7.0 и 7.3). Это юнит 9.6
4. `make php7ru` - установка тестовых сайтов с разными версиями PHP (юнит 9.6)
5. `make mysql` - установка БД MySQL одновременно с созданием юзера под Wordpress (юнит 13.4)
6. `make wordpress` - установка и первичная настройка wordpress (юнит 13.4)
7. `make nginx` - установка nginx (не протестировано до конца)
8. `make nipio` - установка сайта из домена nip.io в nginx (нужны свои данные)
9. `make letsencrypt` - установка системы сертификации (не протестировано до конца)
10. `make bind9` - установка DNS-сервера (не протестировано)
11. `make yandex2` - установка зоны `yandex2.ru` (есть баги)

Соответственно, удаление проводится командой `make del_stage`, где вместо stage нужно подставить название этапа выше.